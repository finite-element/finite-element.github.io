
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3. Meshes &#8212; Finite element course 0.1 documentation</title>
    <link rel="stylesheet" href="_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Function spaces: associating data with meshes" href="4_function_spaces.html" />
    <link rel="prev" title="2. Constructing finite elements" href="2_finite_elements.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head>
  <body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" width="900px" alt="FInAT Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="https://github.com/finite-element/finite-element-course" title="GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="meshes">
<h1>3. Meshes<a class="headerlink" href="#meshes" title="Permalink to this headline">¶</a></h1>
<p>When employing the finite element method, we represent the domain on
which we wish to solve our PDE as a mesh. In order to work with
meshes, we need to have a somewhat more formal mathematical notion of
a mesh. The mesh concepts we will employ here are loosely based on
those in <a class="reference internal" href="zbibliography.html#logg2009" id="id1">[Log09]</a>, and are typical of mesh representations for the
finite element method.</p>
<div class="section" id="mesh-entities">
<h2>3.1. Mesh entities<a class="headerlink" href="#mesh-entities" title="Permalink to this headline">¶</a></h2>
<p>A mesh is composed of <em>topological entities</em>, such as vertices, edges,
polygons and polyhedra.</p>
<div class="theoremenv definition">
<div class="theoremenv_caption definition_caption">Definition<span class="theoremenv_counter definition_counter">4</span></div><div class="theoremenv_body definition_body">The <em>(topological) dimension</em> of a mesh is the largest
dimension among all of the topological entities in a mesh.</div></div><p>In this course we will not consider meshes of manifolds immersed in
higher dimensional spaces (for example the surface of a sphere
immersed in <span class="math">\(\mathbb{R}^3\)</span>) so the topological dimension of the
mesh will always match the geometric dimension of space in which we
are working, so we will simply refer to the <em>dimension</em> of the mesh.</p>
<div class="theoremenv definition">
<div class="theoremenv_caption definition_caption">Definition<span class="theoremenv_counter definition_counter">5</span></div><div class="theoremenv_body definition_body">A topological entity of <em>codimension</em> <span class="math">\(n\)</span> is a topological
entity of dimension <span class="math">\(d-n\)</span> where <span class="math">\(d\)</span> is the dimension of the
mesh.</div></div><p>Armed with these definitions we are able to define names for
topological entities of various dimension and codimension:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="29%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">entity name</th>
<th class="head">dimension</th>
<th class="head">codimension</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>vertex</td>
<td>0</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>edge</td>
<td>1</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>face</td>
<td>2</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>facet</td>
<td>&#160;</td>
<td>1</td>
</tr>
<tr class="row-even"><td>cell</td>
<td>&#160;</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>The cells of a mesh can be polygons or polyhedra of any shape, however
in this course we will restrict ourselves to meshes whose cells are
intervals or triangles. The only other two-dimensional cells
frequently employed are quadrilaterals.</p>
<p>The topological entities of each dimension will be given unique
numbers in order that degrees of freedom can later be associated with
them. We will identify topological entities by an index pair <span class="math">\((d, i)\)</span>
where <span class="math">\(i\)</span> is the index of the entity within the set of <span class="math">\(d\)</span>-dimensional
entities. For example, entity <span class="math">\((0, 10)\)</span> is vertex number 10, and
entity <span class="math">\((1, 10)\)</span> is edge 10. <a class="reference internal" href="#figmesh"><span class="std std-numref">Fig. 3.1</span></a> shows an example
mesh with the topological entities labelled.</p>
<div class="figure" id="id3">
<span id="figmesh"></span><a class="reference internal image-reference" href="_images/mesh.svg"><img alt="_images/mesh.svg" src="_images/mesh.svg" width="80%" /></a>
<p class="caption"><span class="caption-number">Fig. 3.1 </span><span class="caption-text">A triangular mesh showing labelled topological entities: vertices
(black), edges (red), and cells (blue).</span></p>
</div>
</div>
<div class="section" id="reference-cell-entities">
<h2>3.2. Reference cell entities<a class="headerlink" href="#reference-cell-entities" title="Permalink to this headline">¶</a></h2>
<p>The reference cells similarly have locally numbered topological
entities, these are shown in <a class="reference internal" href="#figreferenceentities"><span class="std std-numref">Fig. 3.2</span></a>. The
numbering is a matter of convention: that adopted here is that edges
share the number of the opposite vertex. The orientation of the edges
is also shown, this is always from the lower numbered vertex to the
higher numbered one.</p>
<p>The <a class="reference internal" href="fe_utils.html#fe_utils.reference_elements.ReferenceCell" title="fe_utils.reference_elements.ReferenceCell"><code class="xref py py-class docutils literal"><span class="pre">ReferenceCell</span></code></a> class stores the
local topology of the reference cell. <a class="reference external" href="_modules/fe_utils/reference_elements.html">Read the source</a> and ensure that you
understand the way in which this information is encoded.</p>
<p>The following animation of the numbering of the topological entities
on the reference cell may help in understanding this.</p>
<div class="youtube docutils container">
<iframe src="https://www.youtube.com/embed/7A7JU7bGw0E?modestbranding=1;controls=0;rel=0" style="border: 0; height: 367px; width: 600px">
</iframe></div>
<div class="figure" id="id4">
<span id="figreferenceentities"></span><a class="reference internal image-reference" href="_images/entities.svg"><img alt="_images/entities.svg" src="_images/entities.svg" width="50%" /></a>
<p class="caption"><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Local numbering and orientation of the reference entities.</span></p>
</div>
</div>
<div class="section" id="adjacency">
<span id="secadjacency"></span><h2>3.3. Adjacency<a class="headerlink" href="#adjacency" title="Permalink to this headline">¶</a></h2>
<p>In order to implement the finite element method, we need to integrate
functions over cells, which means knowing which basis functions are
nonzero in a given cell. For the function spaces used in the finite
element method, these basis functions will be the ones whose nodes lie
on the topological entities adjacent to the cell. That is, the
vertices, edges and (in 3D) the faces making up the cell, as well as
the cell itself. One of the roles of the mesh is therefore to provide
a lookup facility for the lower-dimensional mesh entities adjacent to
a given cell.</p>
<div class="theoremenv definition">
<div class="theoremenv_caption definition_caption">Definition<span class="theoremenv_counter definition_counter">6</span></div><div class="theoremenv_body definition_body"><p class="first">Given a mesh <span class="math">\(M\)</span>, then for each <span class="math">\(\dim(M) \geq d_1 &gt; d_2 \geq 0\)</span>
the <em>adjacency</em> function <span class="math">\(\operatorname{Adj}_{d_1,d_2}:\,
\mathbb{N}\rightarrow \mathbb{N}^k\)</span> is the function such that:</p>
<div class="math">
\[\operatorname{Adj}_{d_1,d_2}(i) = (i_0, \ldots i_k)\]</div>
<p>where <span class="math">\((d_1, i)\)</span> is a topological entity and <span class="math">\((d_2, i_0), \ldots,
(d_2, i_k)\)</span> are the adjacent <span class="math">\(d_2\)</span>-dimensional topological entities
numbered in the corresponding reference cell order. If every cell
in the mesh has the same topology then <span class="math">\(k\)</span> will be fixed for each
<span class="math">\((d_1, d_2)\)</span> pair. The correspondence between the orientation of
the entity <span class="math">\((d_1, i)\)</span> and the reference cell of dimension <span class="math">\(d_1\)</span> is
established by specifying that the vertices are numbered in
ascending order <a class="footnote-reference" href="#simplexnumbering" id="id2">[1]</a>. That is, for any entity <span class="math">\((d_1, i)\)</span>:</p>
<div class="math">
\[(i_0, \ldots i_k) = \operatorname{Adj}_{d_1,0}(i) \quad \Longrightarrow \quad i_0 &lt; \ldots &lt;i_k\]</div>
<p class="last">A consequence of this convention is that the global orientation of
all the entities making up a cell also matches their local
orientation.</p>
</div></div><div class="theoremenv example">
<div class="theoremenv_caption example_caption">Example<span class="theoremenv_counter example_counter">7</span></div><div class="theoremenv_body example_body"><p class="first">In the mesh shown in <a class="reference internal" href="#figmesh"><span class="std std-numref">Fig. 3.1</span></a> we have:</p>
<div class="math">
\[\operatorname{Adj}_{2,0}(3) = (1,5,8).\]</div>
<p>In other words, vertices 1, 5 and 8 are adjacent to cell 3. Similarly:</p>
<div class="math">
\[\operatorname{Adj}_{2,1}(3) = (11,5,9).\]</div>
<p class="last">Edges 11, 5, and 9 are local edges 0, 1, and 2 of cell 3.</p>
</div></div></div>
<div class="section" id="mesh-geometry">
<h2>3.4. Mesh geometry<a class="headerlink" href="#mesh-geometry" title="Permalink to this headline">¶</a></h2>
<p>The features of meshes we have so far considered are purely
topological: they deal with the adjacency relationships between
topological entities, but do not describe the locations of those
entities in space. Provided we restrict our attention to meshes in
which the element edges are straight (ie not curved), we can represent
the geometry of the mesh by simply recording the coordinates of the
vertices. The positions of the higher dimensional entities then just
interpolate the vertices of which they are composed. We will later
observe that this is equivalent to representing the geometry in a
vector-valued piecewise linear finite element space.</p>
</div>
<div class="section" id="a-mesh-implementation-in-python">
<h2>3.5. A mesh implementation in Python<a class="headerlink" href="#a-mesh-implementation-in-python" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="fe_utils.html#fe_utils.mesh.Mesh" title="fe_utils.mesh.Mesh"><code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code></a> class provides an implementation of
mesh objects in 1 and 2 dimensions. Given the list of vertices making
up each cell, it constructs the rest of the adjacency function. It
also records the coordinates of the vertices.</p>
<p>The <a class="reference internal" href="fe_utils.html#fe_utils.mesh.UnitSquareMesh" title="fe_utils.mesh.UnitSquareMesh"><code class="xref py py-class docutils literal"><span class="pre">UnitSquareMesh</span></code></a> class creates a
<a class="reference internal" href="fe_utils.html#fe_utils.mesh.Mesh" title="fe_utils.mesh.Mesh"><code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code></a> object corresponding to a regular
triangular mesh of a unit square. Similarly, the
<a class="reference internal" href="fe_utils.html#fe_utils.mesh.UnitIntervalMesh" title="fe_utils.mesh.UnitIntervalMesh"><code class="xref py py-class docutils literal"><span class="pre">UnitIntervalMesh</span></code></a> class performs the
corresponding (rather trivial) function for a unit one dimensional
mesh.</p>
<p>You can observe the numbering of mesh entities in these meshes using
the <code class="docutils literal"><span class="pre">plot_mesh</span></code> script. Run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">plot_mesh</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>for usage instructions.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="simplexnumbering" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>The numbering convention adopted here is very
convenient, but only works for meshes composed
of simplices (vertices, intervals, triangles
and tetrahedra). A more complex convention
would be required to support quadrilateral
meshes.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2018, David A. Ham and Colin J. Cotter.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
    </div>
  </body>
</html>