<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7. Dirichlet boundary conditions &mdash; Finite element course 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Finite element course 0.1 documentation" href="index.html" />
    <link rel="next" title="8. Nonlinear problems" href="8_nonlinear_problems.html" />
    <link rel="prev" title="6. Assembling and solving finite element problems" href="6_finite_element_problems.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head>
  <body role="document">
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" width="900px" alt="FInAT Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="https://github.com/finite-element/finite-element-course" title="GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dirichlet-boundary-conditions">
<h1>7. Dirichlet boundary conditions<a class="headerlink" href="#dirichlet-boundary-conditions" title="Permalink to this headline">¶</a></h1>
<p>The Helmholtz problem we solved in the previous part was chosen to
have homogeneous Neumann or <em>natural</em> boundary conditions, which can
be implemented simply by cancelling the zero surface integral. We can
now instead consider the case of Dirichlet, or <em>essential</em> boundary
conditions. Instead of the Helmholtz problem we solved before, let us
now specify a Poisson problem with homogeneous Dirichlet conditions, find <span class="math">\(u\)</span> in
some finite element space <span class="math">\(V\)</span> such that:</p>
<div class="math" id="equation-poisson">
<span class="eqno">(1)</span>\[-\nabla^2 u = f\]\[u = 0  \textrm{ on }\Gamma\]</div>
<p>In order to implement the Dirichlet conditions, we need to decompose
<span class="math">\(V\)</span> into two parts:</p>
<div class="math">
<span class="eqno">(2)</span>\[V = V_0 \oplus V_\Gamma\]</div>
<p>where <span class="math">\(V_\Gamma\)</span> is the space spanned by those functions in the basis
of <span class="math">\(V\)</span> which are non-zero on <span class="math">\(\Gamma\)</span>, and <span class="math">\(V_0\)</span> is the space spanned
by the remaining basis functions (i.e.  those basis functions which
vanish on <span class="math">\(\Gamma\)</span>). It is a direct consequence of the nodal nature of
the basis that the basis functions for <span class="math">\(V_\Gamma\)</span> are those
corresponding to the nodes on <span class="math">\(\Gamma\)</span> while the basis for <span class="math">\(V_0\)</span> is
composed of all the other functions.</p>
<p>We now write the weak form of <a href="#equation-poisson">(1)</a>, find <span class="math">\(u=u_0 + u_\Gamma\)</span>
with <span class="math">\(u_0 \in V_0\)</span> and <span class="math">\(u_\Gamma \in V_\Gamma\)</span> such that:</p>
<div class="math">
<span class="eqno">(3)</span>\[\int_\Omega \nabla v_0 \cdot \nabla (u_0+u_\Gamma) \, \mathrm{d} x
- \underbrace{\int_\Gamma v_0 \nabla (u_0+u_\Gamma) \cdot
\mathbf{n}\, \mathrm{d} s}_{=0} = \int_\Omega v_0\, f\, \mathrm{d} x
\qquad \forall v_0 \in V_0\]\[u_\Gamma = 0 \textrm{ on } \Gamma\]</div>
<p>There are a number of features of this equation which require some explanation:</p>
<ol class="arabic simple">
<li>We only test with functions from <span class="math">\(V_0\)</span>. This is because it is only
necessary that the differential equation is satisfied on the interior
of the domain: on the boundary of the domain we need only satisfy the
boundary conditions.</li>
<li>The surface integral now cancels because <span class="math">\(v_0\)</span> is guaranteed to be
zero everywhere on the boundary.</li>
<li>The <span class="math">\(u_\Gamma\)</span> definition actually implies that <span class="math">\(u_\Gamma=0\)</span>
everywhere, since all of the nodes in <span class="math">\(V_\Gamma\)</span> lie on the boundary.</li>
</ol>
<p>This means that the weak form is actually:</p>
<div class="math" id="equation-weakpoisson">
<span class="eqno">(4)</span>\[\int_\Omega \nabla v \cdot \nabla u \, \mathrm{d} x
 = \int_\Omega v_0\, f\, \mathrm{d} x
\qquad \forall v_0 \in V_0\]\[u_\Gamma = 0\]</div>
<div class="section" id="an-algorithm-for-homogeneous-dirichlet-conditions">
<h2>7.1. An algorithm for homogeneous Dirichlet conditions<a class="headerlink" href="#an-algorithm-for-homogeneous-dirichlet-conditions" title="Permalink to this headline">¶</a></h2>
<p>The implementation of homogeneous Dirichlet conditions is actually
rather straightforward.</p>
<ol class="arabic simple">
<li>The system is assembled completely ignoring the Dirichlet conditions.
This results in a global matrix and vector which are correct on the rows
corresponding to test functions in <span class="math">\(V_0\)</span>, but incorrect on the <span class="math">\(V_\Gamma\)</span> rows.</li>
<li>The global vector rows corresponding to boundary nodes are set to 0.</li>
<li>The global matrix rows corresponding to boundary nodes are set to 0.</li>
<li>The diagonal entry on each matrix row corresponding to a boundary node is set to 1.</li>
</ol>
<p>This has the effect of replacing the incorrect boundary rows of the
system with the equation <span class="math">\(u_i = 0\)</span> for all boundary node numbers <span class="math">\(i\)</span>.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">This algorithm has the unfortunate side effect of making the global
matrix non-symmetric. If a symmetric matrix is required (for
example in order to use a symmetric solver), then forward
substition can be used to zero the boundary columns in the matrix,
but that is beyond the scope of this module.</p>
</div>
</div>
<div class="section" id="implementing-boundary-conditions">
<h2>7.2. Implementing boundary conditions<a class="headerlink" href="#implementing-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>Let:</p>
<div class="math">
\[f = \left(16 \pi^2 (x_1 - 1)^2 x_1^2 - 2 (x_1 - 1)^2 - 8 (x_1 - 1) x_1 - 2 x_1^2\right) \sin(4 \pi x_0)\]</div>
<p>With this definition, <a href="#equation-weakpoisson">(4)</a> has solution:</p>
<div class="math">
\[u = \sin(4 \pi x_0) (x_1 - 1)^2 x_1^2\]</div>
<div class="theoremenv exercise">
<div class="theoremenv_caption exercise_caption">Exercise<span class="theoremenv_counter exercise_counter">16</span></div><div class="theoremenv_body exercise_body"><p class="first"><code class="docutils literal"><span class="pre">test/solve_poisson.py</span></code> contains a partial implementation of
this problem. You need to implement the <code class="xref py py-func docutils literal"><span class="pre">assemble()</span></code>
function. You should base your implementation on your
<code class="docutils literal"><span class="pre">test/solve_helmholtz.py</span></code> but take into account the difference
in the equation, and the boundary conditions. The
<code class="xref py py-func docutils literal"><span class="pre">boundary_nodes()</span></code> function in <code class="docutils literal"><span class="pre">test/solve_poisson.py</span></code> is
likely to be helpful in implementing the boundary conditions. As
before, run:</p>
<div class="highlight-python"><div class="highlight"><pre>py.test test/solve_poisson.py --help
</pre></div>
</div>
<p class="last">for instructions (they are the same as for
<code class="docutils literal"><span class="pre">test/solve_helmholtz.py</span></code>). Similarly,
<code class="docutils literal"><span class="pre">test/test_poisson_convergence.py</span></code> contains convergence tests
for this problem.</p>
</div></div></div>
<div class="section" id="inhomogeneous-dirichlet-conditions">
<h2>7.3. Inhomogeneous Dirichlet conditions<a class="headerlink" href="#inhomogeneous-dirichlet-conditions" title="Permalink to this headline">¶</a></h2>
<p>The algorithm described here can be extended to inhomogeneous systems
by setting the entries in the global vector to the value of the
boundary condition at the corresponding boundary node. This additional
step is required for the mastery exercise, but will be explained in
more detail in the next section.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, David A. Ham and Colin J. Cotter.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b3.
    </div>
  </body>
</html>